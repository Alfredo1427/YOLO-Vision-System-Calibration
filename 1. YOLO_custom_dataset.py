# -*- coding: utf-8 -*-
"""Yolo Custom Dataset App - JAP.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1c9WFsv4yDmSGtJuVSEJEDTx-zPDGSvnY
"""

!nvidia-smi

!pip install ultralytics

from ultralytics import YOLO
import os
from IPython.display import display
from IPython.display import Image
from IPython import display
display.clear_output()
!yolo mode-checks

!pip install roboflow

from roboflow import Roboflow
rf = Roboflow(api_key="VeDC9zBX5JmeHsCoB584")
project = rf.workspace("computer-vision-aqrzf").project("cup-detection-bon6m")
version = project.version(1)
dataset = version.download("yolov8")

#update paths to image folders for test, train and validation
!yolo task=detect mode=train model=yolov8m.pt data={dataset.location}/data.yaml epochs=20 imgsz=640

Image(filename=f'/content/runs/detect/train3/confusion_matrix.png',width=600)

Image(filename=f'/content/runs/detect/train3/results.png',width=600)

#copy path weights
!yolo task=detect mode=val model=/content/runs/detect/train3/weights/best.pt data={dataset.location}/data.yaml

!yolo task=detect mode=predict model=/content/runs/detect/train3/weights/best.pt conf=0.5 source="/content/Cup-Detection-1/test/images/taza.jpeg"

import glob
from  IPython.display import Image,display

for image_path in glob.glob(f'/content/runs/detect/predict2/*.jpeg'):
  display(Image(filename=image_path, height=600))
  print("\n")